!function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){(function(t){var n,i=function(t,e){return function(){return t.apply(e,arguments)}};n=function(){function t(){this.hasToken=i(this.hasToken,this),this.createIdentification=i(this.createIdentification,this),this.checkIdentificationCallback=i(this.checkIdentificationCallback,this),this.checkIdentification=i(this.checkIdentification,this),this.getIdentification=i(this.getIdentification,this),this.login=i(this.login,this),this.me=void 0,this.identification=void 0,this.getIdentification(),this.getLoginStatus(),this.bind()}return t.prototype.bind=function(){return bind(".button-github-login","click",function(t){return function(){return t.login("github")}}(this)),bind(".button-bitbucket-login","click",function(t){return function(){return t.login("bitbucket")}}(this)),bind(".button-facebook-login","click",function(t){return function(){return t.login("facebook")}}(this)),bind(".button-logout","click",this.logout)},t.prototype.login=function(t){return redirect(AUTH_URL+t)},t.prototype.logout=function(){return Cookies.set("_ggid","",{expires:0,path:"/",domain:".kobeengineer.io"}),setTimeout(function(){return redirect("/")},500)},t.prototype.getLoginStatus=function(){return this.hasToken()?get(API_URL+"me",function(t){return"connected"===t.status?(this.me=t.user,this.me.verified?View.switch("verified-user"):View.switch("user")):(Cookies.set("_ggid","",{expires:0,path:"/",domain:".kobeengineer.io"}),View.switch("guest"))}.bind(this),{token:ACCESS_TOKEN}):View.switch("guest")},t.prototype.getIdentification=function(){return null===localStorage.getItem("identification")?this.createIdentification():(this.identification=localStorage.getItem("identification"),this.checkIdentification(this.identification))},t.prototype.checkIdentification=function(t){return post(API_URL+"client/check",this.checkIdentificationCallback,{identification:t})},t.prototype.checkIdentificationCallback=function(t){if("undefined"==typeof t.message)return this.createIdentification()},t.prototype.createIdentification=function(){return post(API_URL+"client",function(t){var e;return e=t.data.identification,localStorage.setItem("identification",e),this.identification=e}.bind(this))},t.prototype.hasToken=function(){return void 0!==ACCESS_TOKEN&&""!==ACCESS_TOKEN},t}(),t.User=new n,e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){var i,o,r,a,s,l;l=t("./../view/View"),r=t("./../view/FeedView"),s=t("./../component/User"),i=t("./../partial/Feed"),o=t("./../partial/FeedNav"),a=t("./../partial/PostLike")},{"./../component/User":1,"./../partial/Feed":3,"./../partial/FeedNav":4,"./../partial/PostLike":5,"./../view/FeedView":6,"./../view/View":7}],3:[function(t,e,n){var i,o=function(t,e){return function(){return t.apply(e,arguments)}};i=function(){function t(){this.bind=o(this.bind,this),this.callback=o(this.callback,this),this.loadPage=o(this.loadPage,this),this.container=$("#feed"),this.loading=$(".loading-progress"),this.url=API_URL+"feed",this.author_url=API_URL+"feed/author",this.sort=inputGet("sort","newest"),void 0===FEED.sorting[this.sort]&&(this.sort="newest"),this.author=inputGet("author"),this.current_page=1,this.total_page=1,this.ranking_count=1,this.loadPage(),this.bind()}return t.prototype.loadPage=function(){return this.loading.show(),""!==this.author?get(this.author_url,this.callback,{author:this.author,page:this.current_page}):get(this.url,this.callback,{sort:this.sort,page:this.current_page})},t.prototype.callback=function(t){return this.loading.hide(),t.success?(this.total_page=t.data.total_page,""!==this.author?FeedView.feed.create(t.data.posts,this.author):"newest"===this.sort?FeedView.feed.create(t.data.posts):(FeedView.feed.create_ranking(t.data.posts,this.ranking_count),this.ranking_count+=t.data.posts.length)):View.message.failed(this.container)},t.prototype.bind=function(){return $(window).scroll(function(t){return function(){if($(window).scrollTop()+$(window).height()===$(document).height()&&t.current_page<t.total_page)return t.current_page++,t.loadPage()}}(this))},t}(),i=new i,e.exports=i},{}],4:[function(t,e,n){var i,o=function(t,e){return function(){return t.apply(e,arguments)}};i=function(){function t(){this.initial=o(this.initial,this),this.container=$("#feed"),this.sort=inputGet("sort"),this.author=inputGet("author"),""===this.sort&&(this.sort="newest"),void 0===FEED.sorting[this.sort]&&(this.sort="newest"),this.initial()}return t.prototype.initial=function(){return FeedView.feed_nav.create(FEED.sorting,this.sort)},t}(),i=new i,e.exports=i},{}],5:[function(t,e,n){(function(t){var n,i=function(t,e){return function(){return t.apply(e,arguments)}};n=function(){function t(){this.handlePostLike=i(this.handlePostLike,this),this.url=API_URL+"post",this.bind()}return t.prototype.bind=function(){return bind(".button-like","click",this.handlePostLike)},t.prototype.handlePostLike=function(t){var e,n;return void 0===User.me?$("#login-modal").modal("show"):(e=$(t.currentTarget),n=e.attr("data-id"),post(this.url+"/like/"+n,function(t){return t.success?View.like_button.updateLikeCount(e,n,t.data.likes,t.data.liked):alert(MESSAGE.something_wrong)}.bind(this),{},!0))},t}(),t.PostLike=new n,e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,n){(function(t){var n;n=function(){function t(){}return t.prototype.feed={parent:$("#feed"),create:function(t,e,n){var i,o,r;for(null==e&&(e=""),null==n&&(n=""),""!==e&&0===$("#author-header").length&&(n+=this.__header(e)),i=0,o=t.length;i<o;i++)r=t[i],r.content=this.handleContent(r),n+=this.__post(r);return this.parent.append(n),this.parent.linkify()},create_ranking:function(t,e,n){var i,o,r,a;for(null==e&&(e=1),null==n&&(n=""),i=0,o=t.length;i<o;i++)r=t[i],r.content=this.handleContent(r),a="TOP"+e,n+=this.__post(r,a),e++;return this.parent.append(n),this.parent.linkify()},handleContent:function(t,e){var n,i,o;return null==e&&(e=""),void 0!==t.reply_to&&(e+=this.__replyTo(t.reply_to)),"text"!==(n=t.type)&&"link"!==n&&"code"!==n||(e+=t.content),void 0!==t.hashtag&&(e+="<br />"+t.hashtag),"image"===(i=t.type)&&(e+=this.__postImage(t)),"code"===(o=t.type)&&(e+=this.__postCode(t.code)),e},__replyTo:function(t){return'RE: <a href="/post/'+t+'/">#'+PAGE_NAME+t+"</a>&nbsp;"},__postImage:function(t){return'<div>\n  <a href="/post/?id='+t.id+'">\n    <img src="'+t.image+'" class="img-responsive" />\n  </a>\n</div>'},__postCode:function(t){return"<pre>"+t+"</pre>"},__header:function(t){return'<div class="alert alert-block" id="author-header">\n  <img class="pull-left" src="/images/old/mchammer.gif" width="40" style="margin-right:10px;">\n  <h2 style="color: black;">'+t+" 的發文</h2>\n</div>"},__post:function(t,e){return null==e&&(e=""),'<div class="post old-school-scroll">\n  <div class="content">\n    <ul>\n      <li>\n        <strong>\n          '+e+'\n          <a href="/post/?id='+t.id+'"><mark>#'+PAGE_NAME+t.id+'</mark></a>\n        </strong><br />\n        <small style="font-size:14px;">Published at '+t.published_at+'</small><br />\n        <div class="post-content">'+t.content+"</div>\n        <div>\n          <br />\n          "+View.like_button.create(t)+"\n        </div>\n      </li>\n    </ul>\n  </div>\n</div>"}},t.prototype.feed_nav={parent:$("#feed-nav"),create:function(t,e,n){var i,o;null==n&&(n=""),n+=this.__header("Feed filter");for(o in t)i=o===e&&"/feed/"===ROUTE?"active":"",n+=this.__li(o,t[o],i);return this.parent.html(n)},__header:function(t){return'<li class="nav-header">'+t+"</li>"},__li:function(t,e,n){return null==n&&(n=""),'<li class="'+n+'"><a href="/feed/?sort='+t+'">+ '+e+"</a></li>"}},t}(),t.FeedView=new n,e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,e,n){(function(t){var n;n=function(){function t(){}return t.prototype.switch=function(t){return"verified-user"===t?($("body").removeClass("guest").addClass("user verified"),this.navbar.user()):"user"===t?($("body").removeClass("guest").addClass("user"),this.navbar.user()):($("body").removeClass("user verified").addClass("guest"),this.navbar.guest())},t.prototype.navbar={parent:$("#main-menu-left"),user:function(){var t;return t='<li class="dropdown" id="preview-menu">\n  <a class="dropdown-toggle" data-toggle="dropdown" href="#">\n    Member <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a href="/me/posts/">My posts</a></li>\n    <li><a href="/me/setting/">Setting</a></li>\n    <li><a href="javascript:void(0)" class="button-logout">Logout</a></li>\n  </ul>\n</li>',this.parent.append(t)},guest:function(){var t;return t='<li class="dropdown" id="preview-menu">\n  <a class="dropdown-toggle" data-toggle="dropdown" href="#">\n    Login <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a href="javascript:void(0)" class="button-github-login">GitHub登入</a></li>\n    <li><a href="javascript:void(0)" class="button-bitbucket-login">Bitbucket登入</a></li>\n    <li><a href="javascript:void(0)" class="button-facebook-login">Facebook登入</a></li>\n  </ul>\n</li>',this.parent.append(t)}},t.prototype.message={failed:function(t){var e;return e="<span>Load failed</span>",t.append(e)},failed_table:function(t,e){var n;return null==e&&(e=1),n='<tr>\n  <td colspan="'+e+'">\n    <span>Load failed</span>\n  </td>\n</tr>',t.append(n)},null_table:function(t,e,n){var i;return null==e&&(e=1),null==n&&(n=""),i='<tr>\n  <td colspan="'+e+'">\n    <span>No record. '+n+"</span>\n  </td>\n</tr>",t.append(i)},page_not_found:function(t){var e;return e='<div class="alert alert-block alert-danger text-center">\n  <img src="/images/old/shark.gif" /><br /><br />\n  <h4 class="alert-heading">Thiss paage isn avilabie</h4><br />\n  <p>\n    Tho likn yuo flolowed mav bi borken, orr tle pgae mya heva beem remvoed.\n    <br /><br />\n    Wi cann not doo amything fro yyu, pleese fcuk yurself or go home.\n  </p>\n  <br />\n</div>',t.append(e)}},t.prototype.like_button={create:function(t){return this.__view(t.id,t.likes,t.liked)},updateLikeCount:function(t,e,n,i,o){return null==i&&(i=!1),null==o&&(o=""),o+=this.__view(e,n,i),t.parent().replaceWith(o)},__view:function(t,e,n){var i;return null==n&&(n=!1),n=n?" btn-primary":"",i=n?TEXT.liked:TEXT.like,'<div class="like-wrapper">\n  <button type="button" class="btn'+n+' button-like" data-id="'+t+'">\n    <i class="fa fa-thumbs-o-up" aria-hidden="true"></i> '+i+'\n  </button>\n  <span class="post-likes-count">\n    '+e+TEXT.people_liked+"\n  </span>\n</div>"}},t}(),t.View=new n,e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2]);